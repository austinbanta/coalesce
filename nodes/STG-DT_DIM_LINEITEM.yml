fileVersion: 1
id: 5d4f1182-7153-4560-956c-f89f8ec55e20
name: DT_DIM_LINEITEM
operation:
  config:
    downstreamOption: false
    initialize: ON_CREATE
    lagSpecification:
      items:
        - {}
    orderBy:
      items:
        - {}
    orderByDateTime:
      items:
        - {}
    partitionBy:
      items:
        - {}
    recordVersioning: Datetime Column
    refresh_mode: AUTO
    warehouseName: dev_wh_xs
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: STG
  materializationType: Dynamic Table
  metadata:
    appliedNodeTests: []
    columns:
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 7b89bf82-20e7-4f07-a410-b6674b31aad9
          stepCounter: 5d4f1182-7153-4560-956c-f89f8ec55e20
        config: {}
        dataType: STRING
        defaultValue: ""
        description: ""
        isSurrogateKey: true
        name: DT_DIM_LINEITEM_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: "{{ dimensionHistoryPk_adv() }}"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d2b31ff1-ae0f-4c07-b001-33de528bef93
          stepCounter: 5d4f1182-7153-4560-956c-f89f8ec55e20
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        hashDetails: null
        name: L_ORDERKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 34447f4e-be05-4993-b16a-5cd3ad2089cf
                stepCounter: cb761d1c-bad5-464c-bab7-72287e6ca477
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 49a509af-4d27-46b1-affc-e7ae3af9dff1
          stepCounter: 5d4f1182-7153-4560-956c-f89f8ec55e20
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        hashDetails: null
        name: L_PARTKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: acf28ee8-e403-44d7-ab77-b54e046a153f
                stepCounter: cb761d1c-bad5-464c-bab7-72287e6ca477
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2c74b231-1d7f-4c60-acf1-af11f9649af1
          stepCounter: 5d4f1182-7153-4560-956c-f89f8ec55e20
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        hashDetails: null
        name: L_SUPPKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a864e149-a487-4a85-a6fa-719db853b4a0
                stepCounter: cb761d1c-bad5-464c-bab7-72287e6ca477
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7cc78524-690a-4fb9-a2e3-c36d3494be1f
          stepCounter: 5d4f1182-7153-4560-956c-f89f8ec55e20
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        hashDetails: null
        name: L_LINENUMBER
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e242b0c4-9de5-4a94-80ec-0ec7deab775c
                stepCounter: cb761d1c-bad5-464c-bab7-72287e6ca477
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f3e85e66-d94c-43b2-bcc8-244d4bf31b34
          stepCounter: 5d4f1182-7153-4560-956c-f89f8ec55e20
        config: {}
        dataType: NUMBER(12,2)
        description: ""
        hashDetails: null
        name: L_QUANTITY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 11368a1d-1605-4d0a-90a5-713678d2b23a
                stepCounter: cb761d1c-bad5-464c-bab7-72287e6ca477
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a07acc83-9539-4644-854b-75a12881062e
          stepCounter: 5d4f1182-7153-4560-956c-f89f8ec55e20
        config: {}
        dataType: NUMBER(12,2)
        description: ""
        hashDetails: null
        name: L_EXTENDEDPRICE
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 681c8ffe-76d5-458a-a7d3-1e208bc16d20
                stepCounter: cb761d1c-bad5-464c-bab7-72287e6ca477
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4f0d1e87-9e1c-43ac-abbe-551b46df3e1c
          stepCounter: 5d4f1182-7153-4560-956c-f89f8ec55e20
        config: {}
        dataType: NUMBER(12,2)
        description: ""
        hashDetails: null
        name: L_DISCOUNT
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bfb94bf8-0722-4094-a1cf-6d66ecf76c97
                stepCounter: cb761d1c-bad5-464c-bab7-72287e6ca477
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b0f850f0-1290-4fae-8b0b-3bc351a64950
          stepCounter: 5d4f1182-7153-4560-956c-f89f8ec55e20
        config: {}
        dataType: NUMBER(12,2)
        description: ""
        hashDetails: null
        name: L_TAX
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b904f62c-b570-4afc-b6fe-ad79ff07172a
                stepCounter: cb761d1c-bad5-464c-bab7-72287e6ca477
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4e712ff5-3604-4f1a-bae1-59df10bd1d3f
          stepCounter: 5d4f1182-7153-4560-956c-f89f8ec55e20
        config: {}
        dataType: VARCHAR(1)
        description: ""
        hashDetails: null
        name: L_RETURNFLAG
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f796e2e5-2a71-45a1-b4d1-d869d1d71d34
                stepCounter: cb761d1c-bad5-464c-bab7-72287e6ca477
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9f513613-5a0e-447c-902a-29526d179e4a
          stepCounter: 5d4f1182-7153-4560-956c-f89f8ec55e20
        config: {}
        dataType: VARCHAR(1)
        description: ""
        hashDetails: null
        name: L_LINESTATUS
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e76652e7-6a8b-41ee-bfc6-7200b6e2dc2a
                stepCounter: cb761d1c-bad5-464c-bab7-72287e6ca477
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 546b67ff-afb1-481c-80e2-11bbf727a6ff
          stepCounter: 5d4f1182-7153-4560-956c-f89f8ec55e20
        config: {}
        dataType: DATE
        description: ""
        hashDetails: null
        name: L_SHIPDATE
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c563e976-4933-4488-8791-7ac5cf4a349f
                stepCounter: cb761d1c-bad5-464c-bab7-72287e6ca477
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c730bf98-c74e-414a-a529-42cc89ae1adc
          stepCounter: 5d4f1182-7153-4560-956c-f89f8ec55e20
        config: {}
        dataType: DATE
        description: ""
        hashDetails: null
        name: L_COMMITDATE
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 365f690c-643c-456d-ac39-41e9834415d0
                stepCounter: cb761d1c-bad5-464c-bab7-72287e6ca477
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 37253d03-faf6-4707-9a1a-48ddb6037539
          stepCounter: 5d4f1182-7153-4560-956c-f89f8ec55e20
        config: {}
        dataType: DATE
        description: ""
        hashDetails: null
        name: L_RECEIPTDATE
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2628f7cd-8965-4a42-9eec-2c31345ea45d
                stepCounter: cb761d1c-bad5-464c-bab7-72287e6ca477
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e79ea745-4d7e-4579-bf1f-7f5b4941b982
          stepCounter: 5d4f1182-7153-4560-956c-f89f8ec55e20
        config: {}
        dataType: VARCHAR(25)
        description: ""
        hashDetails: null
        name: L_SHIPINSTRUCT
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f35be5ee-38b2-4767-80d0-f29b5fab6806
                stepCounter: cb761d1c-bad5-464c-bab7-72287e6ca477
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b30596ce-2536-4ac3-ad42-4279a01b1457
          stepCounter: 5d4f1182-7153-4560-956c-f89f8ec55e20
        config: {}
        dataType: VARCHAR(10)
        description: ""
        hashDetails: null
        name: L_SHIPMODE
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1c4a2b73-7e33-4516-8443-378c6bfaf45c
                stepCounter: cb761d1c-bad5-464c-bab7-72287e6ca477
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bab6634f-e033-493f-9925-446b5d99004c
          stepCounter: 5d4f1182-7153-4560-956c-f89f8ec55e20
        config: {}
        dataType: VARCHAR(44)
        description: ""
        hashDetails: null
        name: L_COMMENT
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1148282d-d174-4b26-9961-f07c17af5bb6
                stepCounter: cb761d1c-bad5-464c-bab7-72287e6ca477
            transform: ""
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 480704a4-52a5-4aff-82de-bd8f4ecfcb98
          stepCounter: 5d4f1182-7153-4560-956c-f89f8ec55e20
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        isSystemStartDate: true
        name: RECORD_START_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: "{{ order_by_col_adv() }}"
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 0aae4608-8bb7-473b-be97-f0231c20d630
          stepCounter: 5d4f1182-7153-4560-956c-f89f8ec55e20
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        isSystemEndDate: true
        name: RECORD_END_TIME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: LEAD({{ order_by_col_adv()}}) OVER (PARTITION BY {{ partition_by_adv() }} ORDER BY {{ order_by_col_adv() }} asc)
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: cf446e0a-0a7b-4487-8f8e-1c6088bced14
          stepCounter: 5d4f1182-7153-4560-956c-f89f8ec55e20
        config: {}
        dataType: NUMERIC
        defaultValue: ""
        description: ""
        isRecordCurrent: true
        name: RECORD_CURRENT_FLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: CASE WHEN (LEAD({{ order_by_col_adv()}}) OVER (PARTITION BY {{ partition_by_adv() }} ORDER BY {{ order_by_col_adv() }} asc)) IS NULL THEN 1 ELSE 0 END
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 83250fe9-4317-40a3-8524-efc4f72f718b
          stepCounter: 5d4f1182-7153-4560-956c-f89f8ec55e20
        config: {}
        dataType: TIMESTAMP
        defaultValue: ""
        description: ""
        name: RECORD_CREATED_DATE
        nullable: true
        recordCreated: true
        sourceColumnReferences:
          - columnReferences: []
            transform: FIRST_VALUE({{ order_by_col_adv()}}) OVER (PARTITION BY {{ partition_by_adv() }} ORDER BY {{ order_by_col_adv() }} asc)
    cteString: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases: {}
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: DEV
            nodeName: LINEITEM
        join:
          joinCondition: FROM {{ ref('DEV', 'LINEITEM') }} "LINEITEM"
        name: DT_DIM_LINEITEM
        noLinkRefs: []
  name: DT_DIM_LINEITEM
  overrideSQL: false
  schema: ""
  sqlType: "68"
  type: sql
  version: 1
type: Node

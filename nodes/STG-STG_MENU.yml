steps:
  STG_MENU-23965e3b-71d9-419f-8c62-4d40a847c236:
    operation:
      config:
        insertStrategy: INSERT
        postSQL: ""
        preSQL: ""
        testsEnabled: true
        truncateBefore: true
      database: ""
      deployEnabled: true
      description: ""
      isMultisource: false
      locationName: STG
      materializationType: table
      metadata:
        appliedNodeTests: []
        columns:
          - appliedColumnTests:
              hasNull: false
              isDistinct: true
            columnReference:
              columnCounter: 57bb7537-bea5-4514-b153-cf664192eab9
              stepCounter: 23965e3b-71d9-419f-8c62-4d40a847c236
            dataType: NUMBER(19,0)
            description: ""
            hashColumns: []
            hashDetails: null
            name: MENU_ID
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 08c4ce07-8e87-47fd-9ded-48d1c050b9c6
                    stepCounter: ee450be1-9eef-4b3e-9197-d50d0bacc76f
                transform: ""
          - appliedColumnTests:
              hasNull: false
              isDistinct: false
            columnReference:
              columnCounter: 331b4e38-193d-4fd0-af66-ae92636d811c
              stepCounter: 23965e3b-71d9-419f-8c62-4d40a847c236
            dataType: NUMBER(38,0)
            description: ""
            hashColumns: []
            hashDetails: null
            name: MENU_TYPE_ID
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 46ef4462-989c-4d0f-8020-574451914dc7
                    stepCounter: ee450be1-9eef-4b3e-9197-d50d0bacc76f
                transform: ""
          - appliedColumnTests:
              hasNull: false
              isDistinct: false
            columnReference:
              columnCounter: 076011d9-fafd-4a85-88e7-4868a165f888
              stepCounter: 23965e3b-71d9-419f-8c62-4d40a847c236
            dataType: VARCHAR(16777216)
            description: ""
            hashColumns: []
            hashDetails: null
            name: MENU_TYPE
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 3b097eb2-368b-48cc-b92d-80803b72f30d
                    stepCounter: ee450be1-9eef-4b3e-9197-d50d0bacc76f
                transform: ""
          - appliedColumnTests:
              hasNull: false
              isDistinct: false
            columnReference:
              columnCounter: 52b047dd-fa75-4052-ba50-23104e7eef8f
              stepCounter: 23965e3b-71d9-419f-8c62-4d40a847c236
            dataType: VARCHAR(16777216)
            description: ""
            hashColumns: []
            hashDetails: null
            name: TRUCK_BRAND_NAME
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 589c3a4d-9d5d-437d-a7e0-034aa5b6b81a
                    stepCounter: ee450be1-9eef-4b3e-9197-d50d0bacc76f
                transform: ""
          - appliedColumnTests:
              hasNull: false
              isDistinct: false
            columnReference:
              columnCounter: b9776fb9-c37b-417b-b745-bdce01ec2455
              stepCounter: 23965e3b-71d9-419f-8c62-4d40a847c236
            dataType: NUMBER(38,0)
            description: ""
            hashColumns: []
            hashDetails: null
            name: MENU_ITEM_ID
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 94362faf-171b-40e3-93f3-42fa07fc2582
                    stepCounter: ee450be1-9eef-4b3e-9197-d50d0bacc76f
                transform: ""
          - appliedColumnTests:
              hasNull: true
              isDistinct: false
            columnReference:
              columnCounter: bce8bc72-80d7-4b7f-bb47-c95ae75fde98
              stepCounter: 23965e3b-71d9-419f-8c62-4d40a847c236
            dataType: VARCHAR(16777216)
            description: ""
            hashColumns: []
            hashDetails: null
            name: MENU_ITEM_NAME
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: cd4e2d75-dac4-4bc9-bc9f-8754e74ac219
                    stepCounter: ee450be1-9eef-4b3e-9197-d50d0bacc76f
                transform: UPPER("MENU"."MENU_ITEM_NAME")
          - appliedColumnTests:
              hasNull: true
              isDistinct: false
            columnReference:
              columnCounter: 41961b96-7989-4bc2-b4ef-8fd63f2f7e07
              stepCounter: 23965e3b-71d9-419f-8c62-4d40a847c236
            dataType: VARCHAR(16777216)
            description: ""
            hashColumns: []
            hashDetails: null
            name: ITEM_CATEGORY
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: cfda4839-b067-4250-b79d-a37901d6aa1c
                    stepCounter: ee450be1-9eef-4b3e-9197-d50d0bacc76f
                transform: UPPER("MENU"."ITEM_CATEGORY")
          - appliedColumnTests:
              hasNull: false
              isDistinct: false
            columnReference:
              columnCounter: b1fb8563-0de4-40d1-ac4a-ba6c7a7ec0a8
              stepCounter: 23965e3b-71d9-419f-8c62-4d40a847c236
            dataType: VARCHAR(16777216)
            description: ""
            hashColumns: []
            hashDetails: null
            name: ITEM_SUBCATEGORY
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 2be5d18b-12a8-4b76-824e-53fd2a4bca07
                    stepCounter: ee450be1-9eef-4b3e-9197-d50d0bacc76f
                transform: UPPER("MENU"."ITEM_SUBCATEGORY")
          - appliedColumnTests:
              hasNull: false
              isDistinct: false
            columnReference:
              columnCounter: 44585ff9-bc92-406f-9585-fb863d2ea82b
              stepCounter: 23965e3b-71d9-419f-8c62-4d40a847c236
            dataType: NUMBER(38,4)
            description: ""
            hashColumns: []
            hashDetails: null
            name: COST_OF_GOODS_USD
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 347046c0-1aef-46be-86df-6ed7a1f12096
                    stepCounter: ee450be1-9eef-4b3e-9197-d50d0bacc76f
                transform: ""
          - appliedColumnTests:
              hasNull: false
              isDistinct: false
            columnReference:
              columnCounter: 91296a09-bd94-4d8c-919c-5a9ee0a2f6f4
              stepCounter: 23965e3b-71d9-419f-8c62-4d40a847c236
            dataType: NUMBER(38,4)
            description: ""
            hashColumns: []
            hashDetails: null
            name: SALE_PRICE_USD
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 8e39be08-309b-4cc1-90e8-777de3a00439
                    stepCounter: ee450be1-9eef-4b3e-9197-d50d0bacc76f
                transform: ""
          - appliedColumnTests:
              hasNull: false
              isDistinct: false
            columnReference:
              columnCounter: f2cdb454-450c-4c36-b6d1-7d9f8adf5ef8
              stepCounter: 23965e3b-71d9-419f-8c62-4d40a847c236
            dataType: VARIANT
            description: ""
            hashColumns: []
            hashDetails: null
            name: MENU_ITEM_HEALTH_METRICS_OBJ
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 4d073e16-14f8-4baf-a0ac-3b8bd825c2f0
                    stepCounter: ee450be1-9eef-4b3e-9197-d50d0bacc76f
                transform: ""
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: 3081ae5c-c735-4c8f-a9c3-a811f05b0811
              stepCounter: 23965e3b-71d9-419f-8c62-4d40a847c236
            config: {}
            dataType: STRING
            description: ""
            name: menu_item_health_metrics_ingredients
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 4d073e16-14f8-4baf-a0ac-3b8bd825c2f0
                    stepCounter: ee450be1-9eef-4b3e-9197-d50d0bacc76f
                transform: "\"MENU_ITEM_HEALTH_METRICS_OBJ_menu_item_health_metrics_ingredients\".value::STRING"
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: 1978d16e-69ac-44eb-b109-82644e622cf3
              stepCounter: 23965e3b-71d9-419f-8c62-4d40a847c236
            config: {}
            dataType: STRING
            description: ""
            name: menu_item_health_metrics_is_dairy_free_flag
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 4d073e16-14f8-4baf-a0ac-3b8bd825c2f0
                    stepCounter: ee450be1-9eef-4b3e-9197-d50d0bacc76f
                transform: "\"MENU_ITEM_HEALTH_METRICS_OBJ_menu_item_health_metrics\".value:\"is_dairy_free_flag\"::STRING"
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: b53e2b28-5080-4874-9c27-f50591249578
              stepCounter: 23965e3b-71d9-419f-8c62-4d40a847c236
            config: {}
            dataType: STRING
            description: ""
            name: menu_item_health_metrics_is_gluten_free_flag
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 4d073e16-14f8-4baf-a0ac-3b8bd825c2f0
                    stepCounter: ee450be1-9eef-4b3e-9197-d50d0bacc76f
                transform: "\"MENU_ITEM_HEALTH_METRICS_OBJ_menu_item_health_metrics\".value:\"is_gluten_free_flag\"::STRING"
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: 10bf0edc-657b-4082-b8e9-ce5f3d0ba838
              stepCounter: 23965e3b-71d9-419f-8c62-4d40a847c236
            config: {}
            dataType: STRING
            description: ""
            name: menu_item_health_metrics_is_healthy_flag
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 4d073e16-14f8-4baf-a0ac-3b8bd825c2f0
                    stepCounter: ee450be1-9eef-4b3e-9197-d50d0bacc76f
                transform: "\"MENU_ITEM_HEALTH_METRICS_OBJ_menu_item_health_metrics\".value:\"is_healthy_flag\"::STRING"
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: 48648627-6f5f-4b3e-aaba-0704d9dc5559
              stepCounter: 23965e3b-71d9-419f-8c62-4d40a847c236
            config: {}
            dataType: STRING
            description: ""
            name: menu_item_health_metrics_is_nut_free_flag
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 4d073e16-14f8-4baf-a0ac-3b8bd825c2f0
                    stepCounter: ee450be1-9eef-4b3e-9197-d50d0bacc76f
                transform: "\"MENU_ITEM_HEALTH_METRICS_OBJ_menu_item_health_metrics\".value:\"is_nut_free_flag\"::STRING"
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: bbad30a4-44f0-4122-a498-11689992179a
              stepCounter: 23965e3b-71d9-419f-8c62-4d40a847c236
            config: {}
            dataType: DOUBLE
            description: ""
            name: menu_item_id
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 4d073e16-14f8-4baf-a0ac-3b8bd825c2f0
                    stepCounter: ee450be1-9eef-4b3e-9197-d50d0bacc76f
                transform: "\"MENU\".\"MENU_ITEM_HEALTH_METRICS_OBJ\":\"menu_item_id\"::DOUBLE"
        cteString: ""
        enabledColumnTestIDs:
          - hasNull
          - isDistinct
        sourceMapping:
          - aliases: {}
            customSQL:
              customSQL: ""
            dependencies:
              - locationName: TASTY_POS
                nodeName: MENU
            join:
              joinCondition: |-
                FROM {{ ref('TASTY_POS', 'MENU') }} "MENU", 
                lateral flatten(input => "MENU_ITEM_HEALTH_METRICS_OBJ":"menu_item_health_metrics", OUTER => TRUE) "MENU_ITEM_HEALTH_METRICS_OBJ_menu_item_health_metrics", 
                lateral flatten(input => "MENU_ITEM_HEALTH_METRICS_OBJ_menu_item_health_metrics".value:"ingredients", OUTER => TRUE) "MENU_ITEM_HEALTH_METRICS_OBJ_menu_item_health_metrics_ingredients"
            name: STG_MENU
            noLinkRefs: []
      name: STG_MENU
      overrideSQL: false
      schema: ""
      sqlType: Stage
      type: sql
    stepCounter: 23965e3b-71d9-419f-8c62-4d40a847c236
